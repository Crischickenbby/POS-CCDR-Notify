{% extends 'punto_venta.html' %}
{% block title %}Historial de Correos{% endblock %}
{% block content %}
<div class="max-w-5xl mx-auto mt-8">
    <h2 class="text-3xl font-bold text-ccdr-red mb-8">Módulo de Correos Promocionales</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-10">
        <!-- Menos compradores -->
        <div class="bg-white rounded-lg shadow p-6 flex flex-col items-center">
            <i class='bx bx-user-minus text-5xl text-ccdr-red mb-2'></i>
            <h3 class="text-xl font-bold mb-2 text-gray-700">Clientes que menos compran</h3>
            <p class="text-gray-500 mb-4 text-center">Envía cupones de 20% de descuento para incentivar su regreso.</p>
            <a href="{{ url_for('correos_segmentacion', tipo='menos') }}" class="bg-ccdr-red text-white px-6 py-2 rounded-lg font-semibold shadow hover:bg-ccdr-red-dark transition">Ver clientes</a>
        </div>
        <!-- Más compradores -->
        <div class="bg-white rounded-lg shadow p-6 flex flex-col items-center">
            <i class='bx bx-user-plus text-5xl text-green-600 mb-2'></i>
            <h3 class="text-xl font-bold mb-2 text-gray-700">Clientes que más compran</h3>
            <p class="text-gray-500 mb-4 text-center">Premia su lealtad con cupones de 10% o 15% de descuento.</p>
            <a href="{{ url_for('correos_segmentacion', tipo='mas') }}" class="bg-green-600 text-white px-6 py-2 rounded-lg font-semibold shadow hover:bg-green-700 transition">Ver clientes</a>
        </div>
        <!-- Buscar cliente -->
        <div class="bg-white rounded-lg shadow p-6 flex flex-col items-center">
            <i class='bx bx-search text-5xl text-blue-600 mb-2'></i>
            <h3 class="text-xl font-bold mb-2 text-gray-700">Buscar cliente</h3>
            <p class="text-gray-500 mb-4 text-center">Envía un correo promocional a un cliente específico.</p>
            <a href="{{ url_for('correos_buscar') }}" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition">Buscar cliente</a>
        </div>
    </div>
    <div class="bg-white rounded-lg shadow overflow-hidden">
        <table class="min-w-full">
            <thead class="bg-ccdr-red text-white">
                <tr>
                    <th class="py-3 px-4 text-left">Asunto</th>
                    <th class="py-3 px-4 text-left">Tipo</th>
                    <th class="py-3 px-4 text-left">Estado</th>
                    <th class="py-3 px-4 text-left">Fecha de Envío</th>
                    <th class="py-3 px-4 text-left">Destinatarios</th>
                    <th class="py-3 px-4 text-left">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for correo in correos %}
                <tr class="border-b hover:bg-gray-50">
                    <td class="py-2 px-4">{{ correo.asunto }}</td>
                    <td class="py-2 px-4">{{ correo.tipo }}</td>
                    <td class="py-2 px-4">
                        <span class="px-2 py-1 rounded text-xs font-bold {{ 'bg-yellow-200 text-yellow-800' if correo.estado == 'pendiente' else 'bg-green-200 text-green-800' if correo.estado == 'enviado' else 'bg-red-200 text-red-800' }}">
                            {{ correo.estado|capitalize }}
                        </span>
                    </td>
                    <td class="py-2 px-4">{{ correo.fecha_envio or 'Pendiente' }}</td>
                    <td class="py-2 px-4">{{ correo.destinatarios|length }}</td>
                    <td class="py-2 px-4 flex gap-2">
                        {% if correo.estado == 'pendiente' %}
                            <a href="{{ url_for('correos_aprobar', correo_id=correo.id) }}" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-700 transition">Aprobar</a>
                            <a href="{{ url_for('correos_rechazar', correo_id=correo.id) }}" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-700 transition">Rechazar</a>
                        {% endif %}
                        <a href="{{ url_for('correos_detalle', correo_id=correo.id) }}" class="bg-gray-300 text-gray-800 px-3 py-1 rounded hover:bg-gray-400 transition">Ver</a>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="py-10 text-center text-gray-400 text-lg">
                        <i class='bx bx-envelope text-5xl mb-2 text-ccdr-red'></i><br>
                        No hay correos registrados aún.<br>
                        Usa las secciones de arriba para comenzar.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

